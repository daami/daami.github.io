
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>daami&#8217;s blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="真的没有什么高大上的内容，为了将一些新的内容更新到博客里面来，碰到了各种各样的问题，断断续续的弄了好几天。对于一个没玩过ruby的人，第一次弄个ruby的环境也挺辛苦的，好在有stackoverflow和google，问题一点点的都解决掉了。 先列一些名词，如果这些概念都弄明白了， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://daami.github.io/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="daami's blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/jquery.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"-->
<!--link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"-->

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">daami&#8217;s blog</a></h1>
  
    <h2>stay hungry, stay foolish.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="daami.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/01/title/">Octopress搭建各种问题记录</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-01T15:10:25+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>3:10 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>真的没有什么高大上的内容，为了将一些新的内容更新到博客里面来，碰到了各种各样的问题，断断续续的弄了好几天。对于一个没玩过ruby的人，第一次弄个ruby的环境也挺辛苦的，好在有stackoverflow和google，问题一点点的都解决掉了。</p>

<p>先列一些名词，如果这些概念都弄明白了，后面碰到的问题也都不是个事了</p>

<p><strong><a href="http://brew.sh/">brew</a></strong></p>

<p>Homebrew（brew）是使用Ruby进行开发的托管于 <a href="https://github.com/Homebrew/homebrew">GitHub</a> 上的开源的软件包管理系统，简单类比Ubuntu下的apt-get，RedHat下的yum。brew是从软件包仓库下载源代码码到本地进行解压，进而执行 <code>./configure</code> &amp;&amp; <code>make install</code> ，将软件编译安装到单独的目录（<code>/usr/local/Cellar</code>）下，然后软链（symlink）到 <code>/usr/local</code> 目录下，同时会自动检测下载相关依赖库，并自动配置好各种环境变量。</p>

<p><strong><a href="https://jekyllrb.com/">Jekyll</a></strong></p>

<p>Jekyll 是一个简单的博客形态的静态站点生产机器。它有一个模版目录，其中包含原始文本格式的文档，通过 <a href="http://daringfireball.net/projects/markdown/">Markdown</a> （或者 <a href="http://redcloth.org/textile">Textile</a>） 以及 <a href="http://docs.shopify.com/themes/liquid-basics">Liquid</a> 转化成一个完整的可发布的静态网站，你可以发布在任何你喜爱的服务器上。Jekyll 也可以运行在 <a href="http://pages.github.com/">GitHub Page</a> 上，也就是说，你可以使用 GitHub 的服务来搭建你的项目页面、博客或者网站，而且是完全免费的，Octopress也就是对他进行了些封装，用起来舒服点而已。</p>

<p><strong><a href="https://github.com/rbenv/rbenv">rbenv</a>/<a href="https://rvm.io/">RVM</a></strong></p>

<p>ruby多版本管理工具，简单说就是机器上安装了过个ruby，选择所需的ruby版本就靠他们了。RVM历史悠久，各种功能比较全，rbenv是37signals新弄出来的，新出的东西大家都懂得，别人的东西总是各种用着不爽，轻度用户无所谓了。使用 rbenv 后，gem 还是按照原有的方式进行安装、升级，只是 gem 的安装路径是在 rbenv 文件夹中当前 Ruby 版本文件夹下。而且，安装带有可执行文件的 gem 后，需要执行一个特别的命令，告诉 rbenv 更新相应的映射关系，这个命令在安装新版本的 Ruby 后也需要执行：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rbenv rehash</span></code></pre></td></tr></table></div></figure>


<p><strong><a href="https://github.com/rbenv/ruby-build">ruby-build</a></strong></p>

<p>rbenv的一个插件，使得rbenv支持编译安装不同版本Ruby源码，当然ruby-build也是支持在独立环境使用的。查看当前所有安装版本命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rbenv versions</span></code></pre></td></tr></table></div></figure>


<p><strong><a href="https://rubygems.org/">gem</a></strong></p>

<p>RubyGems（gem）是Ruby程序包管理器，Ruby世界的brew吧。RubyGems 将所有的gem包安装到 /[ruby root]/lib/ruby/gems/[ver]/ 目录下，包括cache、doc、gems、specifications 4个目录，cache下放置下载的原生gem包，gems下则放置的是解压过的gem包。当安装过程中遇到问题时，可以进入这些目录，手动删除有问题的gem包，然后重新运行 gem install [gemname] 命令即可。</p>

<p>Gem通常是依照“.gemspec”文件构建的，其为包含了有关Gem信息的<a href="https://zh.wikipedia.org/wiki/YAML">YAML</a>文件。然而，Ruby代码也可以直接建立Gem，这种情况下通常利用<a href="http://rake.rubyforge.org/">Rake</a>来进行。</p>

<p><strong><a href="https://ruby-china.org/topics/26655">Gemfile</a></strong></p>

<p>Gemfile里面定义了项目的软件包依赖，可以类比Python里的requires.txt文件或者maven内的pom文件</p>

<p><strong><a href="http://bundler.io/">bundler</a></strong></p>

<p>bundler是ruby项目（rails）的包依赖管理工具。执行bundle install时，会读取gemfile内的包信息，如果相应的gem已经安装则提示using，否则下载并安装并提示installing</p>

<p><strong><a href="http://rake.rubyforge.org/">rake</a></strong></p>

<p>ruby程序的打包工具，类比make，官方文档是这么说的：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>a simple ruby build program with capabilities similar to make.</span></code></pre></td></tr></table></div></figure>


<p><strong>问题：执行rake时抛错，信息大致是：”Errno::ENOENT: No Such File or Directory - Jekyll ~ Octopress and El Capitan“</strong></p>

<p>网上找了下，文章一大把，看来是共性问题。分析了下，大致的结论就是在新版本的EI Capitan上Octopress有问题，stackoverflow上有一篇非常<a href="http://schalkneethling.github.io/blog/2015/10/16/errno-enoent-no-such-file-or-directory-jekyll-octopress-el-capitan/">不错的文章</a>，workaround也有，那就是升级ruby到2.2.2之后版本，好吧，大致的命令就这几句：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew update
</span><span class='line'>brew install rbenv ruby-build
</span><span class='line'>rbenv install 2.2.3
</span><span class='line'>rbenv local 2.2.3
</span><span class='line'>gem install bundler
</span><span class='line'>rbenv rehash
</span><span class='line'>bundle install</span></code></pre></td></tr></table></div></figure>


<p>看看挺简单的，想都没想就开工了，接下来的问题都基于这几个命令来的</p>

<p><strong>问题：brew update超慢</strong></p>

<p>brew从github上拉包，速度那就不用想了，网上有国内的镜像可用，清华或者中科大都行</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /usr/local
</span><span class='line'>git remote set-url origin http://mirrors.ustc.edu.cn/homebrew.git
</span><span class='line'>less /usr/loca/.git/config</span></code></pre></td></tr></table></div></figure>


<p><strong>问题：使用镜像之后直接报错，brew update执行失败，kernel_require.rb:55:in `require&#8217;: cannot load such file</strong></p>

<p>分析了下网上的说法，大致是升级EI Capitan导致的权限问题，修改brew的git目录权限：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo chown -R $(whoami):admin /usr/local</span></code></pre></td></tr></table></div></figure>


<p>有人还建议清理git目录，猜测是之前break了brew update命令导致git目录状态不对，当时忘记验证下了，执行下面的几句，问题解决了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /usr/local
</span><span class='line'>git reset --hard
</span><span class='line'>git clean -df</span></code></pre></td></tr></table></div></figure>


<p><strong>问题：运行“rbenv local 2.2.3”后，检查ruby版本，“ruby &ndash;version”居然没变</strong></p>

<p>rbenv需要设置环境变量，检查PATH内容：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>env | grep PATH</span></code></pre></td></tr></table></div></figure>


<p>如果没有，设置下.bash_profile：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>RBENV=/Users/XXX/.rbenv/shims:/Users/XXX/.rbenv/bin
</span><span class='line'>PATH=$RBENV:$PATH
</span><span class='line'>source ~/.bash_profile</span></code></pre></td></tr></table></div></figure>


<p><strong>问题：gem install bundler抛错，具体异常忘记了，大致是个页面404</strong></p>

<p>gem源被墙了，之前已经切换过切换淘宝镜像，仔细核对后发现，淘宝镜像的源改成https了，好吧，只能再次改一下</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> gem sources --remove http://ruby.taobao.org/
</span><span class='line'> gem sources -a https://ruby.taobao.org/
</span><span class='line'> gem sources -l</span></code></pre></td></tr></table></div></figure>


<p><strong>问题：rbenv: bundle: command not found，The `bundle&#8217; command exists in these Ruby versions:  2.2.3</strong></p>

<p>重新安装2.2.3，之前尝试切换2.2.2看看好不好用，忘记切回来了，也是醉了，好吧，重新切回啦</p>

<p><strong>问题：执行”bundle install“抛错，Could not locate Gemfile or .bundle/ directory</strong></p>

<p>搞了半天的brew和gem源，在&#8221;/usr/local&#8221;目录弄得正嗨，切回Octopress目录解决</p>

<p><strong>问题：本地修改后，github page上页面没有更新</strong></p>

<p>本地部署页面打开正常，就是远端的页面没有更新。查了比较久，才找到原因，远端部署的文件是选择<em>deploy目录下的内容，部署的方式是在</em>deploy目录下初始化一个git项目，然后push到远端。我这Octopress项目之前创建过，最近从github上重新clone到本地，_deploy目录并没有初始化，执行命令，问题解决：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake setup_github_pages</span></code></pre></td></tr></table></div></figure>


<p><strong>问题：打开页面很慢</strong></p>

<p>定位发现页面有访问fonts.googleapis.com域下的资源文件，这个域名被墙了，本地grep下目录，将找到的所有引用到这个资源的地方注释掉，问题解决</p>

<p>至此终于可以本地跑起来，不容易吧！</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/07/01/title/">Octopress搭建各种问题记录</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
